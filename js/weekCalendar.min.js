(function(){"use strict";var moveCount=0;var date=new Date();var day=date.getDay();var now=new Date(date.getTime()-86400000*day).getTime();function WeekCalendar(option){this.option=option;this.init()}var swiperWrapper=createEl('div',{'class':'swiper-wrapper'});WeekCalendar.prototype={init:function(){var self=this;"use strict";var el=document.querySelector(this.option.el);var container=createEl('div',{'class':'container'});var header=this.createHeader();container.appendChild(header);var currentWeekList=this.createWeekList({date:new Date(now),format:this.option.format},true);var nextWeekList=this.createWeekList({date:new Date(now+86400000*7),format:this.option.format});var perWeekList=this.createWeekList({date:new Date(now-86400000*7),format:this.option.format});swiperWrapper.appendChild(perWeekList);swiperWrapper.appendChild(currentWeekList);swiperWrapper.appendChild(nextWeekList);var banner=createEl('div',{'class':'swiper-container','id':'banner'});banner.appendChild(swiperWrapper);container.appendChild(banner);el.appendChild(container);this.addEvent();var att=attribute(currentWeekList.querySelector('.today'),'calendar-date');this.option.init&&this.option.init(att);var bannerSwiper=new Swiper('#banner',{speed:500,loop:true,initialSlide:1,slideActiveClass:'my-slide-active',slideNextClass:'my-slide-next',slidePrevClass:'my-slide-prev',on:{slideNextTransitionEnd:function(event){"use strict";if(bannerSwiper){moveCount++;var activeDate=new Date(now+86400000*7*moveCount);var nextDate=new Date(activeDate.getTime()+86400000*7);var pervDate=new Date(activeDate.getTime()-86400000*7);var nextEl=self.createWeekList({date:nextDate,format:self.option.format});var pervEl=self.createWeekList({date:pervDate,format:self.option.format});var activeEl=self.createWeekList({date:activeDate,format:self.option.format},true);bannerSwiper.removeAllSlides();bannerSwiper.addSlide(1,nextEl);bannerSwiper.addSlide(2,pervEl);bannerSwiper.addSlide(0,activeEl);bannerSwiper.slideTo(1);self.addEvent();var att=attribute(activeEl.querySelector('.today'),'calendar-date');self.option.transitionEnd&&self.option.transitionEnd(att)}},slidePrevTransitionEnd:function(event){"use strict";if(bannerSwiper){moveCount--;var activeDate=new Date(now+86400000*7*moveCount);var nextDate=new Date(activeDate.getTime()+86400000*7);var pervDate=new Date(activeDate.getTime()-86400000*7);var nextEl=self.createWeekList({date:nextDate,format:self.option.format});var pervEl=self.createWeekList({date:pervDate,format:self.option.format});var activeEl=self.createWeekList({date:activeDate,format:self.option.format},true);bannerSwiper.removeAllSlides();bannerSwiper.addSlide(1,nextEl);bannerSwiper.addSlide(2,pervEl);bannerSwiper.addSlide(0,activeEl);bannerSwiper.slideTo(1);self.addEvent();var att=attribute(activeEl.querySelector('.today'),'calendar-date');self.option.transitionEnd&&self.option.transitionEnd(att)}}}})},createHeader:function(){"use strict";var weekArr=['日','一','二','三','四','五','六'];var ulEl=createEl('ul');for(var i=0;i<7;i++){var liEl=createEl('li',{},weekArr[i]);ulEl.appendChild(liEl)}return ulEl},createWeekList:function(data,currentNode){"use strict";var swiperdiv=createEl('div');swiperdiv.classList.add('swiper-slide');var calendar=createEl('div');calendar.classList.add('calendar');var today=new Date();var date=new Date(data.date);for(var i=0;i<7;i++){var currentdate=new Date(date.getTime()+86400000*i);var divEL=createEl('div',{'calendar-date':[currentdate.getFullYear(),currentdate.getMonth()+1,currentdate.getDate()].join(data.format)});var spEl1=createEl('span',{},currentdate.getDate());var lunar=LunarCalendar.solarToLunar(currentdate.getFullYear(),currentdate.getMonth()+1,currentdate.getDate());var spEl2=createEl('span',{},lunar.solarFestival||lunar.lunarDayName);divEL.appendChild(spEl1);divEL.appendChild(spEl2);calendar.appendChild(divEL);if(currentNode){if(day===i){divEL.classList.add('today')}}if(today.getFullYear()===currentdate.getFullYear()&&today.getMonth()===currentdate.getMonth()&&today.getDate()===currentdate.getDate()){divEL.classList.add('selectColor')}}swiperdiv.appendChild(calendar);return swiperdiv},addEvent:function(){"use strict";var self=this;Array.prototype.forEach.call(swiperWrapper.querySelectorAll('div'),function(node){node.onclick=function(e){window.event?window.event.cancelBubble=true:event.stopPropagation();day=new Date(Date.parse(attribute(this,'calendar-date'))).getDay();this.parentNode.querySelectorAll('div').forEach(item=>{item.classList.remove('today')});this.classList.add('today');self.option.onClick&&self.option.onClick(attribute(this.parentNode,'calendar-date'))}})}};function createEl(tagName,attr,html){"use strict";if(!tagName)return;attr=attr||{};html=html||'';var element=document.createElement(tagName);for(var i in attr){element.setAttribute(i,attr[i])}element.innerHTML=html;return element}function attribute(obj,attr,val){"use strict";switch(arguments.length){case 3:obj.setAttribute(attr,val);break;case 2:return obj.getAttribute(attr);break}}window.WeekCalendar=WeekCalendar})()